# taurus_ammonia
Analyzing intermediate and high density gas kinematics in the Taurus Molecular Cloud and then attempting to build a model to replicate results. The code being added to this repository is part of my final project for my Introduction to Computing (ASTR 501) course and my Computation and Statistical Methods (ASTR 513) course at the University of Arizona. This project is also a part of my research towards my M.S. and Ph.D. in Astronomy and Astrophysics at the University of Arizona. 

## Context
In Section F of the 2020 Astronomy Decadal Survey, which gave an update on the Interstellar Medium and Star and Planet formation, some of the main questions that were highlighted revolved around the drivers of the velocity structures seen in molecular clouds, how the roles that high-density structures play in the star formation process in larger molecular clouds, and how gas flows from parsec scales down to protostars and protoplanetary disks. These are some of the questions that this research aims to answer. 

### How it's done
Back in 2015, Yancy Shirley and Young Min Seo used the Green Bank Telescope to map the Taurus Molecular Cloud (L1495-B218) using the Ammonia (1,1) and (2,2) inversion transitions. These are strong tracers of intermediate and high density gas. Both have an abundance of hyperfine transitions (18 and 24 respectively), which are grouped into 5 and 7 groups respectively. Using Brian Svoboda's nestfit package, which uses Bayesian statistics and MCMC processes, we get posterior distributions of the velocities of the gas, the column densities, velocity dispersion, and a variety of other parameters. This package looks at the evidence to break the spectra into either 0, 1, or 2, velocity components, which can be broken up and analyzed in isolation from the other components that are cospatial along the line of sight.  

I then use the posterior distributions to take the maximum likelihood velocity independently at each pixel. I then took the spines from the Herschel Gould Belt Survey dust maps (Lagdelate et al., 2020), deconvolved them onto the same pixel scale as the ammonia maps, and took a distance transform for the spines. At each pixel this meant that I found the distance to the nearest spine. My goal was to calculate the gradients of the maximum likelihood velocity maps in the directions parallel and perpendicular to the dust spines, which I can achieve using differential geometry. In this case, I will use a differential 1-form by taking the gradient of the distance transform, which will tell me how to measure the gradient for the velocity field. I normalized the differential 1-form so that it is only telling us about the direction and not giving a magnitude to scale the velocity gradients by. I also used the negative gradient of the distance transform, which allowed me to measure the gradient in the direction of the spines rather than away from the spine as a gradient would naturally measure.

To take the differential 1-form for the parallel direction, I rotated all of the vectors from the perpendicular differential 1-form (Chen et al., 2020) by 90$^\circ$ so that the vectors would run in opposite directions on either side of the spines. To measure the gradients of the velocity fields, I first took the gradient of the maximum likelihood velocity maps and decomposed the vectors into the x- and y-components. These were then projected onto the differential 1-forms for the perpendicular and parallel directions to get scalar maps (units of km s$^{-1}$ pixel$^{-1}$. I then binned the projected velocity gradients into groups based on the distance from the spines using Nyquist sampling of half a beam ($\approx$ 3 pixels) and used cumulative distribution functions to show the relationship between the distance from the spines and the magnitude of the projected gradients.

## Table of Contents
